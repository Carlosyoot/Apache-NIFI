<extensionManifest><groupId>intelipost.nifi</groupId><artifactId>nifi-TokenValidator-nar</artifactId><version>1.0</version><systemApiVersion>1.22.0</systemApiVersion><buildInfo><tag>nifi-1.22.0-RC1</tag></buildInfo><extensions><extension><name>intelipost.nifi.processors.TokenValidator.TokenValidator</name><type>PROCESSOR</type><description>Valida tokens JWT assinados com algoritmo RS256, utilizando a chave pública RSA gerada pelo SecretManager. O token é analisado quanto à sua integridade, validade temporal (expiração) e assinatura digital.

Tokens assinados com chaves privadas diferentes da vinculada à chave pública configurada serão rejeitados.

Caso a validação falhe, atributos informativos são adicionados ao FlowFile explicando o motivo, como expiração ou falha de assinatura.

Se a opção de revalidação estiver ativada (Revalidar Token = true) e o token estiver expirado, o processador poderá gerar um novo token com novo tempo de expiração, desde que a chave privada RSA correspondente esteja fornecida nas propriedades.

Permite configurar a origem do token: cabeçalhos HTTP personalizados, parâmetro Authorization padrão, parâmetros de URL ou atributos do FlowFile.

Opcionalmente, pode-se exibir os dados internos (claims) do token como atributos do FlowFile para uso posterior no fluxo.</description><tags><tag>security</tag><tag>token</tag><tag>provider</tag><tag>auth</tag></tags><properties><property><name>origem-token</name><displayName>Origem do Token</displayName><description>Define onde o token JWT será lido: cabeçalhos HTTP, parâmetros, atributos ou header Authorization padrão.</description><defaultValue>Authorization</defaultValue><allowableValues><allowableValue><displayName>Headers</displayName><value>Headers</value><description></description></allowableValue><allowableValue><displayName>Params</displayName><value>Params</value><description></description></allowableValue><allowableValue><displayName>Authorization</displayName><value>Authorization</value><description></description></allowableValue><allowableValue><displayName>Attributes</displayName><value>Attributes</value><description></description></allowableValue></allowableValues><required>true</required><sensitive>false</sensitive><expressionLanguageSupported>false</expressionLanguageSupported><expressionLanguageScope>NONE</expressionLanguageScope><dynamicallyModifiesClasspath>false</dynamicallyModifiesClasspath><dynamic>false</dynamic></property><property><name>attribute-token</name><displayName>Expressão Param</displayName><description>Campo para obter o token através do atributo de um FlowFile. Suporta Expression Language.</description><defaultValue>Authorization</defaultValue><required>false</required><sensitive>false</sensitive><expressionLanguageSupported>true</expressionLanguageSupported><expressionLanguageScope>FLOWFILE_ATTRIBUTES</expressionLanguageScope><dynamicallyModifiesClasspath>false</dynamicallyModifiesClasspath><dynamic>false</dynamic></property><property><name>usar-token</name><displayName>Revalidar Token</displayName><description>Se verdadeiro, e o token estiver expirado. O processador automaticamente irá extender o tempo de expiração</description><defaultValue>true</defaultValue><allowableValues><allowableValue><displayName>true</displayName><value>true</value><description></description></allowableValue><allowableValue><displayName>false</displayName><value>false</value><description></description></allowableValue></allowableValues><required>true</required><sensitive>false</sensitive><expressionLanguageSupported>false</expressionLanguageSupported><expressionLanguageScope>NONE</expressionLanguageScope><dynamicallyModifiesClasspath>false</dynamicallyModifiesClasspath><dynamic>false</dynamic></property><property><name>RSA Public Key</name><displayName>Chave Pública RSA</displayName><description>Chave pública RSA para validar o token JWT. Deve ser a chave pública correspondente à chave privada usada para assinar.</description><required>true</required><sensitive>true</sensitive><expressionLanguageSupported>false</expressionLanguageSupported><expressionLanguageScope>NONE</expressionLanguageScope><dynamicallyModifiesClasspath>false</dynamicallyModifiesClasspath><dynamic>false</dynamic></property><property><name>RSA Private Key</name><displayName>Chave Privada RSA</displayName><description>Chave privada RSA usada para renovar o token JWT. Necessária apenas se a opção de renovação estiver ativada.</description><required>false</required><sensitive>true</sensitive><expressionLanguageSupported>false</expressionLanguageSupported><expressionLanguageScope>NONE</expressionLanguageScope><dynamicallyModifiesClasspath>false</dynamicallyModifiesClasspath><dynamic>false</dynamic></property><property><name>exibir-claims</name><displayName>Exibir Claims do Token</displayName><description>Se verdadeiro, exibe os dados internos (claims) do token nos atributos do FlowFile.</description><defaultValue>false</defaultValue><allowableValues><allowableValue><displayName>true</displayName><value>true</value><description></description></allowableValue><allowableValue><displayName>false</displayName><value>false</value><description></description></allowableValue></allowableValues><required>true</required><sensitive>false</sensitive><expressionLanguageSupported>false</expressionLanguageSupported><expressionLanguageScope>NONE</expressionLanguageScope><dynamicallyModifiesClasspath>false</dynamicallyModifiesClasspath><dynamic>false</dynamic></property></properties><relationships><relationship><name>Sucesso</name><description>Sucesso na validação do token JWT.</description><autoTerminated>false</autoTerminated></relationship><relationship><name>Falha</name><description>Falha na validação do token JWT.</description><autoTerminated>false</autoTerminated></relationship></relationships><readsAttributes><readsAttribute><name></name><description></description></readsAttribute></readsAttributes><writesAttributes><writesAttribute><name></name><description></description></writesAttribute></writesAttributes><seeAlso></seeAlso></extension></extensions></extensionManifest>